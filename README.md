# atop_raw

`atop_raw` is a python library to read raw log files generated by [`atop`](https://github.com/Atoptool/atop).

It only supports version 1.26, and as this file depend on system header files, it also probably only supports files generated from Debian 8 x86_64 machines.

## Dependences

It uses:

- [`numpy`](https://numpy.org/)

And optionally:

- [`pycstruct`](https://github.com/midstar/pycstruct) to deserialize binary streams
- [`castxml`](https://github.com/CastXML/CastXML>) to parse C header file

To be able to edit more easily atop header files.

## Installation

```
pip install .
```

## Example

This displays the whole content of a file as python dicts.

```
import atop_raw

filename = "atop_20210202"
with open(filename, "rb") as stream:
    reader = atop_raw.create_reader(stream)
    print(reader.header)

    for record in reader.records:
        print(record.header)
        print(record.sstat)
        print()
        for pstat in record.pstats:
            cmd = pstat["gen"]["cmdline"].decode("ascii")
            pid = pstat["gen"]["pid"]
            print(f"{pid:>5} {cmd}")
        print()
        print(record.curtime)
```
